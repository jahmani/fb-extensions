<ion-header>
  <ion-toolbar>
    <ion-title>Products Gallary</ion-title>
    <ion-buttons slot="start">
      <ion-button [routerLink]="['../edit-product', 'new']" routerLinkActive="router-link-active">
        <ion-icon slot="start" name="create"></ion-icon>
        new Product
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>
<ion-content>
  <store-app-repository-tags-input #productNameWordsInput type="array"
    [suggestions]="(suggestions|async) || []"></store-app-repository-tags-input>
  <store-app-repository-tags-input #productBatchsOptionValuesInput [showInputCtrl]=true type="array" label="batch"
    [suggestions]="(productBatchsOptionValues$|async) || []"></store-app-repository-tags-input>
  <cdk-virtual-scroll-viewport itemSize="auto">

    <div class="gallary_container" *ngIf=" products$|async as products ; else noProducts">
      <ng-container *ngFor="let  prod of products; let i=index">
        <div class="image_container" (click)="previewProduct === prod ? previewProduct= null : previewProduct = prod">
          <img style="object-fit: cover;" *ngIf="prod!.imageIds && prod!.imageIds![0]" [priority]="i<20"
            [ngSrc]="prod!.imageIds![0]|imgIdtoThumbUre:200" alt="{{prod.name}}" fill />
        </div>
        <div class="prod-preview" *ngIf="previewProduct === prod" [routerLink]="['../edit-product', prod.id]">
          <div class="prod-preview-content">

            <div class="card " style="flex: auto;">
              <div class=" card-content">
                <div class="slides" *ngIf="prod!.imageIds && prod.imageIds[0]">
                  <div id="slide-1" class=" image_container" *ngFor="let item of prod!.imageIds">
                    <img  loading="lazy" [ngSrc]="item |imgIdtoThumbUre:600"
                    alt="{{prod.name}}" fill />
                  </div>
                </div>

              </div>

              <ion-text class="card-title" color="primary">
                <h1>{{prod.name}}</h1>
              </ion-text>

            </div>
          </div>

        </div>
      </ng-container>
      <ng-container *ngIf="products.length < 2">
        <div class="image_container placeholder" >
        </div>
        <ng-container *ngIf="products.length < 3">
          <div class="image_container placeholder" >
          </div>

        </ng-container>
      </ng-container>
      

    </div>
    <ng-template #noProducts>
      noProducts
    </ng-template>

    <!--           

    <ion-row   *ngIf="products$| async as products">
        <ion-col size="auto"  *cdkVirtualFor="let  prod of products; let i=index" class="photo-grid-item">
          <img  class="grid-img" [src]="getthumbUrl(prod!.imageIds![0])" alt="" />
        </ion-col>
</ion-row> -->


  </cdk-virtual-scroll-viewport>
</ion-content>